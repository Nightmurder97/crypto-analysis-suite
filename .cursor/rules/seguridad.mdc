---
description: Reglas de seguridad para protección de secretos, variables de entorno y control de versiones seguro
globs: .env*,.gitignore,src/**/*.ts,src/**/*.tsx
alwaysApply: true
---

# SEGURIDAD

## REGLA: PROTECCIÓN DE SECRETOS

- Secretos (claves API, credenciales) SIEMPRE mediante variables de entorno
- Archivos .env SIEMPRE en .gitignore
- NUNCA hardcodear claves o tokens en código
- Verificar .gitignore antes de commits

## REGLA CRÍTICA: NUNCA EXPONER CLAVES EN CHAT

- NUNCA usar `cat .env`, `grep API_KEY` o `echo $API_KEY` sin enmascarar
- SOLO mostrar últimos 4 caracteres: `****${VAR: -4}`
- Usar protocol seguro: `source .env` + `export` sin mostrar contenido
- En documentación: usar `[CLAVE_OCULTA]` o `TU_CLAVE_AQUI`

## CONTROL DE VERSIONES

- Commits frecuentes y pequeños
- Sincronización regular con rama remota
- Antes de git filter-repo: HAZ COPIA DE SEGURIDAD
- Verificar repositorios Git anidados
